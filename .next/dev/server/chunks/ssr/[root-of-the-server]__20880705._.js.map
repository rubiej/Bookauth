{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 34, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/James/bookauth/pages/dashboard.js"],"sourcesContent":["import { useEffect, useState } from \"react\";\r\nimport { useRouter } from \"next/router\";\r\n\r\nexport default function Dashboard() {\r\n  const [books, setBooks] = useState([]);\r\n  const [newBook, setNewBook] = useState({ title: \"\", author: \"\" });\r\n  const [editingId, setEditingId] = useState(null);\r\n  const [editedBook, setEditedBook] = useState({ title: \"\", author: \"\" });\r\n  const [username, setUsername] = useState(\"User\");\r\n  const router = useRouter();\r\n\r\n  const token = typeof window !== \"undefined\" ? localStorage.getItem(\"token\") : null;\r\n\r\n  useEffect(() => {\r\n    if (!token) return router.push(\"/\");\r\n    fetchBooks();\r\n    decodeUserFromToken();\r\n  }, []);\r\n\r\n  const fetchBooks = async () => {\r\n    try {\r\n      const res = await fetch(\"http://localhost:3001/api/books\", {\r\n        headers: { Authorization: `Bearer ${token}` },\r\n      });\r\n      const data = await res.json();\r\n      setBooks(data);\r\n    } catch (err) {\r\n      console.error(\"âŒ Failed to fetch books:\", err);\r\n    }\r\n  };\r\n\r\n  const decodeUserFromToken = () => {\r\n    try {\r\n      const payload = JSON.parse(atob(token.split(\".\")[1]));\r\n      setUsername(payload.username || \"User\");\r\n    } catch (err) {\r\n      console.error(\"âŒ Invalid token:\", err);\r\n      setUsername(\"User\");\r\n    }\r\n  };\r\n\r\n  const handleAdd = async (e) => {\r\n    e.preventDefault();\r\n    const res = await fetch(\"http://localhost:3001/api/books\", {\r\n      method: \"POST\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n        Authorization: `Bearer ${token}`,\r\n      },\r\n      body: JSON.stringify(newBook),\r\n    });\r\n    if (res.ok) {\r\n      setNewBook({ title: \"\", author: \"\" });\r\n      fetchBooks();\r\n    }\r\n  };\r\n\r\n  const startEdit = (book) => {\r\n    setEditingId(book._id);\r\n    setEditedBook({ title: book.title, author: book.author });\r\n  };\r\n\r\n  const handleEdit = async (e) => {\r\n    e.preventDefault();\r\n    const res = await fetch(`http://localhost:3001/api/books/${editingId}`, {\r\n      method: \"PUT\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n        Authorization: `Bearer ${token}`,\r\n      },\r\n      body: JSON.stringify(editedBook),\r\n    });\r\n    if (res.ok) {\r\n      setEditingId(null);\r\n      fetchBooks();\r\n    }\r\n  };\r\n\r\n  const handleDelete = async (id) => {\r\n    const res = await fetch(`http://localhost:3001/api/books/${id}`, {\r\n      method: \"DELETE\",\r\n      headers: { Authorization: `Bearer ${token}` },\r\n    });\r\n    if (res.ok) fetchBooks();\r\n  };\r\n\r\n  const handleLogout = () => {\r\n    localStorage.removeItem(\"token\");\r\n    router.push(\"/\");\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-100\">\r\n      {/* ðŸ§­ Navigation Bar */}\r\n      <nav className=\"bg-blue-600 text-white px-6 py-4 flex justify-between items-center\">\r\n        <h1 className=\"text-xl font-bold\">ðŸ“š BookAuth</h1>\r\n        <div className=\"flex items-center space-x-4\">\r\n          <span className=\"text-sm\">Logged in as <strong>{username}</strong></span>\r\n          <button\r\n            onClick={handleLogout}\r\n            className=\"bg-white text-blue-600 px-3 py-1 rounded hover:bg-gray-100\"\r\n          >\r\n            Logout\r\n          </button>\r\n        </div>\r\n      </nav>\r\n\r\n      {/* âž• Add Book Form */}\r\n      <div className=\"p-6\">\r\n        <form onSubmit={handleAdd} className=\"mb-6 bg-white p-4 rounded shadow\">\r\n          <h2 className=\"text-lg font-semibold mb-2\">Add a New Book</h2>\r\n          <input\r\n            type=\"text\"\r\n            placeholder=\"Title\"\r\n            className=\"border p-2 mr-2\"\r\n            value={newBook.title}\r\n            onChange={(e) => setNewBook({ ...newBook, title: e.target.value })}\r\n          />\r\n          <input\r\n            type=\"text\"\r\n            placeholder=\"Author\"\r\n            className=\"border p-2 mr-2\"\r\n            value={newBook.author}\r\n            onChange={(e) => setNewBook({ ...newBook, author: e.target.value })}\r\n          />\r\n          <button className=\"bg-blue-500 text-white px-4 py-2 rounded\">Add</button>\r\n        </form>\r\n\r\n        {/* ðŸ“‹ Book List */}\r\n        <ul className=\"space-y-4\">\r\n          {books.map((book) => (\r\n            <li key={book._id} className=\"bg-white p-4 rounded shadow\">\r\n              {editingId === book._id ? (\r\n                <form onSubmit={handleEdit} className=\"flex items-center space-x-2\">\r\n                  <input\r\n                    type=\"text\"\r\n                    className=\"border p-2\"\r\n                    value={editedBook.title}\r\n                    onChange={(e) => setEditedBook({ ...editedBook, title: e.target.value })}\r\n                  />\r\n                  <input\r\n                    type=\"text\"\r\n                    className=\"border p-2\"\r\n                    value={editedBook.author}\r\n                    onChange={(e) => setEditedBook({ ...editedBook, author: e.target.value })}\r\n                  />\r\n                  <button className=\"bg-green-500 text-white px-3 py-1 rounded\">Save</button>\r\n                  <button\r\n                    type=\"button\"\r\n                    className=\"bg-gray-300 px-3 py-1 rounded\"\r\n                    onClick={() => setEditingId(null)}\r\n                  >\r\n                    Cancel\r\n                  </button>\r\n                </form>\r\n              ) : (\r\n                <div className=\"flex justify-between items-center\">\r\n                  <div>\r\n                    <p className=\"font-semibold\">{book.title}</p>\r\n                    <p className=\"text-sm text-gray-600\">by {book.author}</p>\r\n                  </div>\r\n                  <div className=\"space-x-2\">\r\n                    <button\r\n                      className=\"bg-yellow-500 text-white px-3 py-1 rounded\"\r\n                      onClick={() => startEdit(book)}\r\n                    >\r\n                      Edit\r\n                    </button>\r\n                    <button\r\n                      className=\"bg-red-500 text-white px-3 py-1 rounded\"\r\n                      onClick={() => handleDelete(book._id)}\r\n                    >\r\n                      Delete\r\n                    </button>\r\n                  </div>\r\n                </div>\r\n              )}\r\n            </li>\r\n          ))}\r\n        </ul>\r\n      </div>\r\n    </div>\r\n  );\r\n}"],"names":[],"mappings":"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","debugId":null}}]
}